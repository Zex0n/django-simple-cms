{% load mptt_tags %}
<ul class="nav navbar-nav">
    {% recursetree menu.mainmenu.items %}
        <li class="{% if not node.is_leaf_node %}dropdown{% endif %}">
            <a href="{{ node.page.get_absolute_url }}" {% if not node.is_leaf_node %}class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"{% endif %}>{{ node }} {% if not node.is_leaf_node %}<span class="caret"></span>{% endif %}</a>
            {% if not node.is_leaf_node %}
                <ul class="dropdown-menu">
                    {{ children }}
                </ul>
            {% endif %}
        </li>
    {% endrecursetree %}
</ul>